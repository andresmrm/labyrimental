webpackJsonp([1],[/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/
function(e,t,n){"use strict";function a(){d.state.game.stage.disableVisibilityChange=!0,d.state.game.load.audio("song",["assets/audio/song.ogg"])}function o(){var e=d.state.game.add.audio("song",1,!0);d.state.game.sound.setDecodedCallback([e],function(){return(0,i.playSong)("song")},this),d.state.game.createdSounds={song:e},(0,r.mainLoad)()}function s(){}var r=n(30),i=n(13),d=n(1);d.state.game=new Phaser.Game(0,0,Phaser.AUTO,"app",{preload:a,create:o,update:s})},/*!**********************!*\
  !*** ./src/store.js ***!
  \**********************/
function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={water:{position:[10,0,0],walkablePos:[9,0,0],soundName:"stream",gain:15,color:14190},earth:{position:[8,10,0],walkablePos:[8,9,0],soundName:"earth",gain:2,color:3632640},air:{position:[0,-2,0],walkablePos:[0,-1,0],soundName:"wind",gain:4,color:3801969},fire:{position:[-2,7,0],walkablePos:[-1,7,0],soundName:"fire",gain:4,color:7223040}};t.shrines=n;var a={state:"pregame",level:1,position:[4,4,0],direction:"e",followed:[],presences:{},darkPresence:{},power:[],filters:[],tint:null,loadingVision:!1,playIntro:!0,currentSong:null};t.state=a,window.s=a},,/*!**********************!*\
  !*** ./src/utils.js ***!
  \**********************/
function(e,t){"use strict";function n(e){return Math.floor(Math.random()*e)}function a(e,t){var n=!0;for(var a in e)if(e[a]!=t[a]){n=!1;break}return n}function o(e){return e.split("_").map(function(e){return parseInt(e)})}function s(e){return e.join("_")}function r(e,t){return s(e)+"_"+t}function i(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function d(e){return"n"==e?"w":g[g.indexOf(e)-1]}function u(e){return"w"==e?"n":g[g.indexOf(e)+1]}function l(e){return d(d(e))}function c(e){return[e.x,e.y,e.width,e.height]}Object.defineProperty(t,"__esModule",{value:!0}),t.randInt=n,t.equalArrays=a,t.textToPos=o,t.posToText=s,t.posDirToText=r,t.posDist=i,t.rotLeft=d,t.rotRight=u,t.rot180=l,t.getBounds=c;var g=["n","e","s","w"]},,,,/*!***********************!*\
  !*** ./src/vision.js ***!
  \***********************/
function(e,t,n){"use strict";function a(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];e||(u.state.loadingVision=!1),u.state.img&&u.state.img.destroy(),u.state.img=u.state.game.add.image(0,0,(0,i.posDirToText)(u.state.position,u.state.direction)),u.state.layers.back.add(u.state.img);var t=Math.min(u.state.game.width/u.state.img.width,u.state.game.height/u.state.img.height);u.state.img.scale.setTo(t),u.state.img.x=(u.state.game.width-u.state.img.width)/2,u.state.img.y=(u.state.game.height-u.state.img.height)/2;var n=["x","y","width","height"];n.map(function(e){return u.state.img[e]=Math.round(u.state.img[e])}),u.state.tint&&(u.state.img.tint=u.state.tint),u.state.filters.length&&(u.state.img.filters=u.state.filters),(0,d.setInterfaceBounds)((0,i.getBounds)(u.state.img)),u.state.onTap&&(u.state.img.inputEnabled=!0,u.state.img.events.onInputUp.add(u.state.onTap,this)),u.state.onSetVision&&u.state.onSetVision(e)}function o(e,t,n){return e.effect&&e.effect.destroy(),e.effect=e.game.add.graphics(0,0),e.effect.beginFill(t,n),e.effect.drawRect(e.img.x,e.img.y,e.img.width,e.img.height),e.effect.endFill(),e.layers.front.add(e.effect),e.effect}function s(e){var t=(0,i.posDirToText)(e.position,e.direction);e.game.cache.checkImageKey(t)?a():(e.loadingVision=!0,e.game.load.image(t,"assets/map/"+t+".jpg").onFileComplete.add(function(){return a()}),e.game.load.start())}function r(){u.state.game.scale.setGameSize(window.innerWidth,window.innerHeight),a(!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.addEffect=o,t.loadVision=s,t.resize=r;var i=n(3),d=n(14),u=n(1);window.addEventListener("resize",function(){return u.state.game.time.events.add(200,r)},!1)},,,,/*!**********************!*\
  !*** ./src/audio.js ***!
  \**********************/
function(e,t){"use strict";function n(e,t){e.listener.setPosition(t[0]*i,t[2]+1,-t[1]*i)}function a(e,t){var n=r(t,3),a=n[0],o=n[1],s=n[2];e.listener.setOrientation(a,s,-o,0,1,0)}function o(e,t){var n=r(t,3),a=n[0],o=n[1],s=n[2];e.setPosition(a*i,s*i,-o*i)}function s(e,t,n){var a=arguments.length<=3||void 0===arguments[3]?1:arguments[3],s=e.add.audio(n),r=e.sound.context.createPanner();r.panningModel="HRTF",r.distanceModel="exponential",r.refDistance=1,r.maxDistance=4,r.rolloffFactor=4,s.gainNode.disconnect(),s.gainNode.connect(r);var i=e.sound.context.createGain();return r.connect(i),i.connect(e.sound.masterGain),i.gain.value=a,o(r,t),s.loop=!0,s.play(),{audio:s,panner:r,volume:i}}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],a=!0,o=!1,s=void 0;try{for(var r,i=e[Symbol.iterator]();!(a=(r=i.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(d){o=!0,s=d}finally{try{!a&&i["return"]&&i["return"]()}finally{if(o)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.setListenerPos=n,t.setAudioOri=a,t.setPannerPos=o,t.addSound=s;var i=1},/*!*****************************!*\
  !*** ./src/createAudios.js ***!
  \*****************************/
function(e,t,n){"use strict";function a(){var e=i.state.game.add.audio("steps");e.allowMultiple=!0;for(var t=0;6>t;t++)e.addMarker(t,t,1);Object.assign(i.state.game.createdSounds,{steps:e,harp:i.state.game.add.audio("harp",.8),harpStart:i.state.game.add.audio("harp_start",.8),button:i.state.game.add.audio("button",.5),magic:i.state.game.add.audio("magic"),magicNo:i.state.game.add.audio("magic_no"),magicRequest:i.state.game.add.audio("magic_request"),magicArrived:i.state.game.add.audio("magic_arrived"),darkSpell:i.state.game.add.audio("dark_spell",1.5),darkSong:i.state.game.add.audio("dark_song",1,!0),darkPresence:i.state.game.add.audio("dark_presence",1,!0),rarr:i.state.game.add.audio("rarr"),end2:i.state.game.add.audio("end2")})}function o(){for(var e in i.shrines){var t=i.shrines[e];t.sound||(t.sound=(0,r.addSound)(i.state.game,t.position,t.soundName,t.gain));var n=i.state.presences[e];n.sound?(0,r.setPannerPos)(n.sound.panner,n.position):n.sound=(0,r.addSound)(i.state.game,n.position,t.soundName,t.gain),s(e,1)}if(2==i.state.level){var a=i.state.darkPresence;a.sound?((0,r.setPannerPos)(a.sound.panner,a.position),i.state.darkPresence.sound.volume.gain.value=1):i.state.darkPresence.sound=(0,r.addSound)(i.state.game,a.position,"dark_presence",1.5)}else i.state.darkPresence.sound&&(i.state.darkPresence.sound.volume.gain.value=0)}function s(e,t){i.state.presences[e].sound.volume.gain.value=i.shrines[e].gain*t}Object.defineProperty(t,"__esModule",{value:!0}),t.createCommonAudios=a,t.createPositionedAudios=o,t.changePresenceSoundGain=s;var r=n(11),i=n(1)},/*!*********************!*\
  !*** ./src/game.js ***!
  \*********************/
function(e,t,n){"use strict";function a(e){var t=arguments.length<=1||void 0===arguments[1]?2e3:arguments[1];y.state.currentSong&&y.state.currentSong.stop(),y.state.currentSong=y.state.game.createdSounds[e],y.state.currentSong.fadeIn(t,!0,"")}function o(){var e=arguments.length<=0||void 0===arguments[0]?2e3:arguments[0];y.state.currentSong&&y.state.currentSong.isPlaying&&y.state.currentSong.fadeOut(e)}function s(){4==y.state.followed.length?y.state.won():y.state.lost()}function r(e){"playing"==y.state.state&&o(),["pregame","starting"].includes(y.state.state)&&((0,v.addEffect)(y.state,0,1),"starting"==y.state.state&&(y.state.state="playing",o(),y.state.game.add.tween(y.state.effect).to({alpha:0},2e3,"Linear",!0),e||1==y.state.level&&y.state.game.createdSounds.harpStart.play())),e||(d(),u())}function i(){if("playing"==y.state.state){var e=p(y.state.position);if(e&&y.state.power.includes(e)&&!y.state.presences[e].arrived&&(2==y.state.level||!y.state.followed.length))return y.state.followed.push(e),(0,k.changePresenceSoundGain)(e,.25),y.state.game.createdSounds.magicRequest.play(),2==y.state.level&&(y.state.tint+=y.shrines[e].color,y.state.filters.length&&(y.state.filters=[])),!0;y.state.game.createdSounds.magicNo.play()}return!1}function d(){var e=!0,t=!1,n=void 0;try{for(var a,o=y.state.followed[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var s=a.value;(0,_.changePresencePos)(y.state.presences[s],y.state.position,2e3)}}catch(r){t=!0,n=r}finally{try{!e&&o["return"]&&o["return"]()}finally{if(t)throw n}}}function u(){var e=g(y.state.position);if(e)if(1==y.state.level)if(y.state.followed.length||y.state.presences[e].arrived)y.state.followed.includes(e)&&l(y.state,e);else{var t=!0;y.state.power.length&&y.state.power[0]==e&&(t=!1),t&&c(e,!0)}else y.state.power.includes(e)||c(e)}function l(e,t){e.presences[t].arrived=!0,(0,k.changePresenceSoundGain)(t,1),e.followed.splice(e.followed.indexOf(t),1),e.power.splice(e.power.indexOf(t),1),e.game.createdSounds.magicArrived.play(),Object.keys(e.presences).reduce(function(t,n){return t&&e.presences[n].arrived},!0)&&e.game.createdSounds.magicArrived.onStop.add(function(){e.won(),e.game.createdSounds.magicArrived.onStop.removeAll()})}function c(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];t&&(y.state.power=[]),y.state.power.push(e);var n=(0,v.addEffect)(y.state,y.shrines[e].color,.5);n.alpha=0;var a=y.state.game.add.tween(n).to({alpha:1},1e3,"Linear"),o=y.state.game.add.tween(n).to({alpha:0},1e3,"Linear");a.chain(o),a.start(),y.state.game.createdSounds.magic.play(),o.onComplete.add(function(){return n.destroy()})}function g(e){for(var t in y.shrines)if((0,w.equalArrays)(e,y.shrines[t].walkablePos))return t;return null}function p(e){for(var t in y.state.presences)if((0,w.equalArrays)(e,y.state.presences[t].position)&&!y.state.followed.includes(t))return t;return null}function f(){y.state.game.createdSounds.button.play()}function m(){for(var e in y.state.presences)y.state.followed.push(e),l(y.state,e)}function h(){for(var e in y.state.presences)y.state.followed.push(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.playSong=a,t.stopSong=o,t.touchedDarkPresence=s,t.onSetVision=r,t.interact=i,t.playButtonSound=f;var w=n(3),_=n(15),v=n(7),y=n(1),k=n(12);window.cheats={l1:m,l2:h}},/*!**************************!*\
  !*** ./src/interface.js ***!
  \**************************/
function(e,t,n){"use strict";function a(){var e=arguments.length<=0||void 0===arguments[0]?!1:arguments[0];return e?document.getElementById("interface-outer"):document.getElementById("interface")}function o(e){var t=a(!0);e.map(function(e,n){t.style[this[n]]=e+"px"},["left","top","width","height"]),a().style.padding=e[2]/8+"px "+e[3]/8+"px"}function s(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?null:arguments[2];r();var o=u[e];n&&(o=o.replace("{{}}",n)),a().innerHTML='<div class="page">'+o+"</div>",t&&window.playButtonSound(),window.scrollTo(0,0)}function r(){var e=a();e.style.zIndex=1,e.style.opacity=1;var t=a(!0);t.style.pointerEvents="auto"}function i(){var e=a();e.style.zIndex=-1,e.style.opacity=0,e.innerHTML="";var t=a(!0);t.style.pointerEvents="none"}function d(){var e=document.getElementById("loading-screen");e&&e.parentNode.removeChild(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.setInterfaceBounds=o,t.openPage=s,t.showInterface=r,t.hideInterface=i,t.hideLoadingScreen=d;var u={mainmenu:n(77),controls:n(61),instructions:n(66),instrorstart:n(65),history:n(64),cantsee:n(60),end1:n(63),l2intro:n(70),l2intro2:n(71),l2intro3:n(72),l2intro3a:n(73),l2intro4:n(74),l2intro5:n(75),lost2:n(76),l2end1:n(67),l2end2:n(68),l2end3:n(69),credits:n(62)};window.openPage=s},/*!*************************!*\
  !*** ./src/movement.js ***!
  \*************************/
function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=p["default"][(0,f.posToText)(w.state.position)][e];if(t){var n=w.state.position;w.state.position=t;var a=function(e){return(0,m.setListenerPos)(w.state.game.sound.context,e)};return u(n,t,a,500,w.state,"Move"),w.state.game.createdSounds.steps.play((0,f.randInt)(5)),!0}return!1}function s(e,t){var n=w.state.darkPresence.position,a=function(e){"playing"==w.state.state&&((0,m.setPannerPos)(w.state.darkPresence.sound.panner,e),w.state.darkPresence.position=e,(0,f.posDist)(e,w.state.position)<.5&&t&&t())},o=2500*(0,f.posDist)(n,e);u(n,e,a,o,w.state.darkPresence)}function r(e,t){if("playing"==w.state.state&&!w.state.loadingVision){var n=!1,a=!1;switch(t){case"UP":n=o(w.state.direction);break;case"DOWN":n=o((0,f.rot180)(w.state.direction));break;case"LEFT":i(w.state,"left"),a=!0;break;case"RIGHT":i(w.state,"right"),a=!0}(a||n)&&(0,h.loadVision)(w.state),n&&w.state.onMoved&&w.state.onMoved()}}function i(e,t){var n=_[e.direction];"left"==t?e.direction=(0,f.rotLeft)(e.direction):e.direction=(0,f.rotRight)(e.direction);var a=_[e.direction],o=function(t){return(0,m.setAudioOri)(e.game.sound.context,t)};u(n,a,o,500,e,"Rotate")}function d(e,t,n){var a=e.position;e.position=t;var o=function(t){return(0,m.setPannerPos)(e.sound.panner,t)};u(a,t,o,n,e)}function u(e,t,n,a,o,s){var r=c(e,3),i=r[0],d=r[1],u=r[2],l=c(t,3),g=l[0],p=l[1],f=l[2],m={x:i,y:d,z:u},h=w.state.game.add.tween(m).to({x:g,y:p,z:f},a,"Linear"),_=function(){return n([m.x,m.y,m.z])};if(h.onUpdateCallback(_),h.onComplete.add(_),h.start(),o){var v="tween";s&&(v+=s),o[v]&&o[v].stop(),o[v]=h}}function l(){(0,m.setListenerPos)(w.state.game.sound.context,w.state.position),(0,m.setAudioOri)(w.state.game.sound.context,_[w.state.direction])}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){var n=[],a=!0,o=!1,s=void 0;try{for(var r,i=e[Symbol.iterator]();!(a=(r=i.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(d){o=!0,s=d}finally{try{!a&&i["return"]&&i["return"]()}finally{if(o)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.changeDarkPresencePos=s,t.move=r,t.changePresencePos=d,t.tweenPos=u,t.initPlayerPos=l;var g=n(21),p=a(g),f=n(3),m=n(11),h=n(7),w=n(1),_={e:[1,0,0],s:[0,-1,0],w:[-1,0,0],n:[0,1,0]}},,,,,,/*!***************************!*\
  !*** ./assets/map/map.js ***!
  \***************************/
function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={"4_0_0":{e:[5,0,0],n:[4,1,0],w:[3,0,0]},"6_6_0":{s:[6,5,0],e:[7,6,0],w:[5,6,0]},"2_6_0":{s:[2,5,0],e:[3,6,0]},"3_7_0":{s:[3,6,0],e:[4,7,0]},"8_3_0":{s:[8,2,0],n:[8,4,0]},"1_2_0":{e:[2,2,0],n:[1,3,0],w:[0,2,0]},"3_0_0":{e:[4,0,0],w:[2,0,0]},"0_2_0":{s:[0,1,0],e:[1,2,0]},"-1_7_0":{e:[0,7,0]},"3_4_0":{e:[4,4,0],w:[2,4,0]},"6_7_0":{e:[7,7,0],w:[5,7,0]},"6_4_0":{s:[6,3,0],e:[7,4,0],n:[6,5,0],w:[5,4,0]},"1_8_0":{s:[1,7,0],w:[0,8,0]},"1_0_0":{n:[1,1,0],w:[0,0,0]},"8_6_0":{s:[8,5,0],w:[7,6,0]},"6_3_0":{s:[6,2,0],n:[6,4,0]},"4_4_0":{s:[4,3,0],e:[5,4,0],n:[4,5,0],w:[3,4,0]},"8_8_0":{s:[8,7,0],n:[8,9,0]},"6_5_0":{s:[6,4,0],n:[6,6,0]},"5_1_0":{s:[5,0,0],n:[5,2,0]},"3_2_0":{s:[3,1,0]},"0_7_0":{n:[0,8,0],w:[-1,7,0]},"7_0_0":{e:[8,0,0],w:[6,0,0]},"4_3_0":{s:[4,2,0],n:[4,4,0]},"7_7_0":{s:[7,6,0],e:[8,7,0],n:[7,8,0],w:[6,7,0]},"2_2_0":{w:[1,2,0]},"7_2_0":{s:[7,1,0],e:[8,2,0],w:[6,2,0]},"4_1_0":{s:[4,0,0]},"1_1_0":{s:[1,0,0],e:[2,1,0],w:[0,1,0]},"2_1_0":{s:[2,0,0],e:[3,1,0],w:[1,1,0]},"2_5_0":{n:[2,6,0],w:[1,5,0]},"8_2_0":{n:[8,3,0],w:[7,2,0]},"2_4_0":{s:[2,3,0],e:[3,4,0],w:[1,4,0]},"8_4_0":{s:[8,3,0],n:[8,5,0],w:[7,4,0]},"0_5_0":{n:[0,6,0]},"1_4_0":{s:[1,3,0],e:[2,4,0],n:[1,5,0],w:[0,4,0]},"6_1_0":{s:[6,0,0],e:[7,1,0]},"0_1_0":{e:[1,1,0],n:[0,2,0]},"5_2_0":{s:[5,1,0],e:[6,2,0],w:[4,2,0]},"1_7_0":{s:[1,6,0],e:[2,7,0],n:[1,8,0]},"1_5_0":{s:[1,4,0],e:[2,5,0]},"2_3_0":{n:[2,4,0],w:[1,3,0]},"3_6_0":{n:[3,7,0],w:[2,6,0]},"4_6_0":{s:[4,5,0],n:[4,7,0]},"0_8_0":{s:[0,7,0],e:[1,8,0]},"5_7_0":{e:[6,7,0],w:[4,7,0]},"9_0_0":{w:[8,0,0]},"3_1_0":{n:[3,2,0],w:[2,1,0]},"8_9_0":{s:[8,8,0]},"4_8_0":{e:[5,8,0],w:[3,8,0]},"5_4_0":{e:[6,4,0],w:[4,4,0]},"0_0_0":{s:[0,-1,0],e:[1,0,0]},"4_2_0":{e:[5,2,0],n:[4,3,0]},"3_8_0":{e:[4,8,0],w:[2,8,0]},"5_0_0":{n:[5,1,0],w:[4,0,0]},"7_6_0":{e:[8,6,0],n:[7,7,0],w:[6,6,0]},"2_8_0":{s:[2,7,0],e:[3,8,0]},"8_7_0":{n:[8,8,0],w:[7,7,0]},"2_7_0":{n:[2,8,0],w:[1,7,0]},"0_-1_0":{n:[0,0,0]},"0_4_0":{s:[0,3,0],e:[1,4,0]},"6_0_0":{e:[7,0,0],n:[6,1,0]},"4_7_0":{s:[4,6,0],e:[5,7,0],w:[3,7,0]},"7_4_0":{e:[8,4,0],w:[6,4,0]},"1_6_0":{n:[1,7,0],w:[0,6,0]},"6_2_0":{e:[7,2,0],n:[6,3,0],w:[5,2,0]},"5_8_0":{e:[6,8,0],w:[4,8,0]},"0_3_0":{e:[1,3,0],n:[0,4,0]},"2_0_0":{e:[3,0,0],n:[2,1,0]},"5_6_0":{e:[6,6,0]},"7_8_0":{s:[7,7,0],w:[6,8,0]},"8_1_0":{w:[7,1,0]},"4_5_0":{s:[4,4,0],n:[4,6,0]},"0_6_0":{s:[0,5,0],e:[1,6,0]},"8_0_0":{e:[9,0,0],w:[7,0,0]},"8_5_0":{s:[8,4,0],n:[8,6,0]},"1_3_0":{s:[1,2,0],e:[2,3,0],n:[1,4,0],w:[0,3,0]},"7_1_0":{e:[8,1,0],n:[7,2,0],w:[6,1,0]},"6_8_0":{e:[7,8,0],w:[5,8,0]}};t["default"]=n,e.exports=t["default"]},,,,,,,/*!**********************!*\
  !*** ./src/input.js ***!
  \**********************/
function(e,t,n){"use strict";function a(e,t){var n=this,a=["UP","DOWN","LEFT","RIGHT"];a.map(function(t){return d.state.game.input.keyboard.addKey(Phaser.Keyboard[t]).onDown.add(e,n,null,t)}),d.state.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR).onDown.add(t,this,null)}function o(e,t){d.state.onTap=function(n,a){return s(a,e,t)}}function s(e,t,n){var a=e.x,o=e.y,s=.28,u=(0,i.getBounds)(d.state.img),l=r(u,4),c=l[0],g=l[1],p=l[2],f=l[3],m=g+f*s,h=g+f*(1-s),w=c+p*s,_=c+p*(1-s);o>m&&h>o?w>a?t(null,"LEFT"):a>_?t(null,"RIGHT"):n():a>w&&_>a&&(m>o?t(null,"UP"):o>h&&t(null,"DOWN"))}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],a=!0,o=!1,s=void 0;try{for(var r,i=e[Symbol.iterator]();!(a=(r=i.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(d){o=!0,s=d}finally{try{!a&&i["return"]&&i["return"]()}finally{if(o)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.initKeyboardInput=a,t.initMouseInput=o;var i=n(3),d=n(1)},/*!***********************!*\
  !*** ./src/levels.js ***!
  \***********************/
function(e,t,n){"use strict";function a(){var e=arguments.length<=0||void 0===arguments[0]?2e3:arguments[0];y.state.state="finished",(0,m.addEffect)(y.state,0,1),y.state.effect.alpha=0,y.state.game.add.tween(y.state.effect).to({alpha:1},e,"Linear",!0)}function o(){y.state.game.createdSounds.harp.play(),(0,v.playSong)("song"),a(),(0,f.openPage)("end1",!1)}function s(){y.state.playIntro?(0,f.openPage)("controls"):c()}function r(){localStorage.lastLevel=1,y.state.playIntro?((0,f.hideInterface)(),(0,v.stopSong)(1e3),y.state.game.createdSounds.darkSpell.play(),y.state.game.createdSounds.darkSpell.onStop.add(function(){y.state.game.createdSounds.darkSpell.onStop.removeAll(),(0,h.randomizePresencePositions)(y.state.position),(0,f.openPage)("l2intro",!1),(0,v.playSong)("darkSong",1e3)})):((0,h.randomizePresencePositions)(y.state.position),c())}function i(){var e=y.state.position,t=function(e){return(0,k.setListenerPos)(y.state.game.sound.context,e)};(0,w.tweenPos)(e,[e[0],e[1],10],t,1e3,y.state,"Move")}function d(){y.state.state="finished",i(),y.state.game.createdSounds.end2.play(),y.state.game.createdSounds.end2.onStop.add(function(){y.state.game.createdSounds.end2.onStop.removeAll(),a(1e3),(0,f.openPage)("l2end1",!1),(0,v.playSong)("song")})}function u(){y.state.game.createdSounds.rarr.play(),a(1e3),y.state.playIntro=!1,(0,f.openPage)("lost2",!1,P[(0,p.randInt)(P.length)]),i()}function l(e){y.state.level=e,y.state.position=[4,4,0],y.state.followed=[],y.state.power=[],1==e?((0,h.randomizePresencePositions)(y.state.position),y.state.won=o,y.state.intro=s,y.state.tint=16777215,y.state.filters=[],y.state.onMoved=null):2==e&&(y.state.won=d,y.state.lost=u,y.state.intro=r,y.state.tint=2105376,y.state.filters=[y.state.game.createdFilters.gray],y.state.onMoved=function(){return(0,w.changeDarkPresencePos)(y.state.position,v.touchedDarkPresence)})}function c(){(0,f.hideInterface)(),(0,w.initPlayerPos)(),(0,_.createPositionedAudios)(),y.state.state="starting",(0,m.loadVision)(y.state)}function g(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1];l(e),y.state.intro(),t&&(0,v.playButtonSound)()}Object.defineProperty(t,"__esModule",{value:!0}),t.startLevel=c,t.pickLevel=g;var p=n(3),f=n(14),m=n(7),h=n(31),w=n(15),_=n(12),v=n(13),y=n(1),k=n(11),P=["Raaaaarrrrr!!!!","Embrace Darkness!","You can't win!","You can't hide!","You can't escape!","You are doomed!","I found you.","Again?","Run faster next time.","Muhahahahah!","Unstoppable!"]},/*!***********************!*\
  !*** ./src/loader.js ***!
  \***********************/
function(e,t,n){"use strict";function a(){l.state.game.load.onLoadComplete.add(function(){l.state.game.load.onLoadComplete.removeAll(),o()},this),l.state.game.load.audio("button",["assets/audio/button.ogg"]),l.state.game.load.audio("stream",["assets/audio/stream_cold.ogg"]),l.state.game.load.audio("wind",["assets/audio/wind.ogg"]),l.state.game.load.audio("fire",["assets/audio/fire.ogg"]),l.state.game.load.audio("earth",["assets/audio/earth.ogg"]),l.state.game.load.audio("magic",["assets/audio/magic_slow.ogg"]),l.state.game.load.audio("magic_request",["assets/audio/magic_request.ogg"]),l.state.game.load.audio("magic_arrived",["assets/audio/magic_arrived.ogg"]),l.state.game.load.audio("magic_no",["assets/audio/magic_no.ogg"]),l.state.game.load.audio("harp",["assets/audio/harp.ogg"]),l.state.game.load.audio("harp_start",["assets/audio/harp_start.ogg"]),l.state.game.load.audio("steps",["assets/audio/steps.ogg"]),l.state.game.load.audio("dark_spell",["assets/audio/dark_spell.ogg"]),l.state.game.load.audio("dark_presence",["assets/audio/dark_presence.ogg"]),l.state.game.load.audio("dark_song",["assets/audio/dark_song.ogg"]),l.state.game.load.audio("rarr",["assets/audio/rarr.ogg"]),l.state.game.load.audio("end2",["assets/audio/end2.ogg"]),l.state.game.load.script("gray","https://cdn.rawgit.com/photonstorm/phaser/master/filters/Gray.js");var e=(0,s.posDirToText)(l.state.position,l.state.direction);l.state.game.load.image(e,"assets/map/"+e+".jpg"),l.state.game.load.start(),console.log("Loading...")}function o(){console.log("Done loading"),(0,i.hideLoadingScreen)(),l.state.game.stage.backgroundColor="#000000",l.state.layers={back:l.state.game.add.group(),front:l.state.game.add.group()},l.state.onSetVision=c.onSetVision,(0,g.resize)();for(var e in l.shrines)l.state.presences[e]={};l.state.game.createdFilters={gray:l.state.game.add.filter("Gray")},(0,u.createCommonAudios)(),(0,d.initKeyboardInput)(r.move,c.interact),(0,d.initMouseInput)(r.move,c.interact),localStorage.getItem("lastLevel")?(0,i.openPage)("mainmenu",!1):(0,p.pickLevel)(1,!1)}Object.defineProperty(t,"__esModule",{value:!0}),t.mainLoad=a;var s=n(3),r=n(15),i=n(14),d=n(28),u=n(12),l=n(1),c=n(13),g=n(7),p=n(29);window.playButtonSound=c.playButtonSound,window.pickLevel=p.pickLevel,window.startLevel=p.startLevel},/*!************************!*\
  !*** ./src/randPos.js ***!
  \************************/
function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t={},n=[];for(var a in l.state.presences)l.state.presences[a].arrived=!1;for(var o in d["default"])t[o]=!0;s(t,e,1);for(var o in l.shrines)s(t,l.shrines[o].position,2);2==l.state.level?(n=Object.keys(t),l.state.darkPresence.position=(0,u.textToPos)(n[(0,u.randInt)(n.length)])):l.state.darkPresence.position=[100,100,100];var r=!1,i=10;do{var c=Object.assign({},t);for(var o in l.shrines)if(n=Object.keys(c),n.length){var g=(0,u.textToPos)(n[(0,u.randInt)(n.length)]);l.state.presences[o].position=g,s(c,g,2)}else r=!0,console.log("ops...");i--}while(r&&i);r&&console.log("OMG! I failed! =O")}function s(e,t,n){for(var a=r(t,3),o=a[0],s=a[1],i=a[2],d=o-n;o+n>=d;d++)for(var l=s-n;s+n>=l;l++)for(var c=i-n;i+n>=c;c++)delete e[(0,u.posToText)([d,l,c])]}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],a=!0,o=!1,s=void 0;try{for(var r,i=e[Symbol.iterator]();!(a=(r=i.next()).done)&&(n.push(r.value),!t||n.length!==t);a=!0);}catch(d){o=!0,s=d}finally{try{!a&&i["return"]&&i["return"]()}finally{if(o)throw s}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.randomizePresencePositions=o;var i=n(21),d=a(i),u=n(3),l=n(1)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,/*!************************************************!*\
  !*** ./~/text-loader!./src/pages/cantsee.html ***!
  \************************************************/
function(e,t){e.exports="<p>But here comes the tricky part: you can't see the presences. You can only hear them.\n    And that is also how you'll need to find out which presence belongs to which shrine.</p>\n<p>One last tip: once you gain the power to communicate with a presence, you lose the power to communicate with the others.</p>\n<a onClick=\"window.openPage('instructions')\">Back</a>\n<a onClick=\"window.startLevel()\">Ok! Here I go!</a>\n"},/*!*************************************************!*\
  !*** ./~/text-loader!./src/pages/controls.html ***!
  \*************************************************/
function(e,t){e.exports="<p>In this game you will need to be guided by sounds. So a headphone is <b>highly</b> recommended.</p>\n<p>It's also <b>highly</b> recommended to play it using a recent Firefox or Chromium/Chrome. Firefox seems to play the sounds better.</p>\n<p>Use the <b>arrow keys</b> to walk and the <b>spacebar</b> to interact.\nOr click or touch the top/bottom parts of the screen to walk forward/backward and the left/right to rotate. Click/tap the middle of the screen to interact.</p>\n<a onClick=\"window.openPage('instrorstart')\">Ok</a>\n"},/*!************************************************!*\
  !*** ./~/text-loader!./src/pages/credits.html ***!
  \************************************************/
function(e,t){e.exports='<p>This is a free software game!</p>\n<p>Made by: Andr√©s M. R. Martano</p>\n<p>Based on works from many others.</p>\n\n<ul>\n  <li>\n    <a href="https://github.com/andresmrm/labyrimental" target="_blank">Check full credits and source repository.</a>\n  </li>\n  <li>\n    <a onClick="window.openPage(\'mainmenu\')">Main menu</a>\n  </li>\n<ul>\n'},/*!*********************************************!*\
  !*** ./~/text-loader!./src/pages/end1.html ***!
  \*********************************************/
function(e,t){e.exports='<p>Wow! Congratulations!</p>\n<p>You helped the presenses! They are very grateful!</p>\n<a onClick="window.pickLevel(2)">Yay!</a>\n'},/*!************************************************!*\
  !*** ./~/text-loader!./src/pages/history.html ***!
  \************************************************/
function(e,t){e.exports="<p>This magic labyrinth has four elemental shrines, each inhabited by an elemental presence.\nA powerfull spell casted nearby shaked the land, confusing the presences and spreading them around the labyrinth. Now they need your help to guide them back to their shrines.</p>\n<a onClick=\"window.openPage('instructions')\">Next</a>\n"},/*!*****************************************************!*\
  !*** ./~/text-loader!./src/pages/instrorstart.html ***!
  \*****************************************************/
function(e,t){e.exports='<p>Do you want to read the instructions or find out how to play by yourself?</p>\n<a onClick="window.openPage(\'history\')">I don\'t want to guess how to play this weird game. Show me the instructions.</a>\n<a onClick="window.startLevel()">Challenge is my second name. Just start the game.</a>\n'},/*!*****************************************************!*\
  !*** ./~/text-loader!./src/pages/instructions.html ***!
  \*****************************************************/
function(e,t){e.exports="<p>Before you can help one of the presences, you need to visit her shrine. There you will gain the power to communicate with her. After that you need to find the presence around the labyrinth, stay very close and interact, calling her to follow you. Then you can bring her back to her shrine.</p>\n<a onClick=\"window.openPage('history')\">Back</a>\n<a onClick=\"window.openPage('cantsee')\">Next</a>\n"},/*!***********************************************!*\
  !*** ./~/text-loader!./src/pages/l2end1.html ***!
  \***********************************************/
function(e,t){e.exports="<p>We did it! United the elemental presences could communicate with the dark presence and lessen her anger.</p>\n<a onClick=\"window.openPage('l2end2')\">Great!</a>\n"},/*!***********************************************!*\
  !*** ./~/text-loader!./src/pages/l2end2.html ***!
  \***********************************************/
function(e,t){e.exports="<p>It seems she's angry because of the powerfull spells casted and she thought you're the one responsible for them.</p>\n<p>Maybe it's time to find out who is behind all this...</p>\n<a onClick=\"window.openPage('l2end3')\">...</a>\n"},/*!***********************************************!*\
  !*** ./~/text-loader!./src/pages/l2end3.html ***!
  \***********************************************/
function(e,t){e.exports="<p>Continue?</p>\n<a onClick=\"window.openPage('credits')\">End</a>\n"},/*!************************************************!*\
  !*** ./~/text-loader!./src/pages/l2intro.html ***!
  \************************************************/
function(e,t){e.exports="<p>Uh oh...</p>\n<a onClick=\"window.openPage('l2intro2')\">WHAT WAS THAT?</a>\n<a onClick=\"window.openPage('l2intro2')\">Not again...</a>\n"},/*!*************************************************!*\
  !*** ./~/text-loader!./src/pages/l2intro2.html ***!
  \*************************************************/
function(e,t){e.exports="<p>It seems a powerfull spell was casted again. But this time, it unleashed a... dark presence.</p>\n<p>What are we going to do now?</p>\n<a onClick=\"window.openPage('l2intro3')\">Hey! You're the one supposed to tell me that!</a>\n<a onClick=\"window.startLevel()\">Just stay out of the way and I'll solve it quick.</a>\n"},/*!*************************************************!*\
  !*** ./~/text-loader!./src/pages/l2intro3.html ***!
  \*************************************************/
function(e,t){e.exports="<p>Hum... Ok... Don't panic.</p>\n<p>After the powerfull spell was casted again, the four elemental presences should be spread across the labyrinth once again. But maybe, if you can unite them, they can do something about it.</p>\n<a onClick=\"window.openPage('l2intro3a')\">They can't even find the way back to their shines!</a>\n<a onClick=\"window.openPage('l2intro4')\">Ok...</a>\n"},/*!**************************************************!*\
  !*** ./~/text-loader!./src/pages/l2intro3a.html ***!
  \**************************************************/
function(e,t){e.exports="<p>Hey! Don't underestimate the presences! Besides, I have no other idea...</p>\n<a onClick=\"window.openPage('l2intro4')\">Great...</a>\n"},/*!*************************************************!*\
  !*** ./~/text-loader!./src/pages/l2intro4.html ***!
  \*************************************************/
function(e,t){e.exports="<p>Ok, so first you'll need to enter each of the four shines again, to gain the hability to communicate with each presence. This time, given the circustances, you should be able to accumulate the power to communicate with all of them at the same time. Then find them around the labyrinth.</p>\n<a onClick=\"window.openPage('l2intro5')\">...</a>\n"},/*!*************************************************!*\
  !*** ./~/text-loader!./src/pages/l2intro5.html ***!
  \*************************************************/
function(e,t){e.exports="<p>Be cautious: don't face the dark presence before you have all the four elemental presences with you. Like the others, you can't see the dark presence, but I'm sure you'll know when she is close. Run. And don't forget: she can pass through walls and she seems ANGRY.</p>\n<a onClick=\"window.startLevel()\">...</a>\n"},/*!**********************************************!*\
  !*** ./~/text-loader!./src/pages/lost2.html ***!
  \**********************************************/
function(e,t){e.exports='<p>{{}}</p>\n<ul>\n  <li>\n    <a onClick="window.pickLevel(2)">Restart</a>\n  </li>\n  <li>\n    <a onClick="window.openPage(\'mainmenu\')">Main menu</a>\n  </li>\n<ul>\n'},/*!*************************************************!*\
  !*** ./~/text-loader!./src/pages/mainmenu.html ***!
  \*************************************************/
function(e,t){e.exports='<p>Select a level:</p>\n<ul>\n  <li>\n    <a onClick="window.pickLevel(1)">Level 1</a>\n  </li>\n  <li>\n    <a onClick="window.pickLevel(2)">Level 2</a>\n  </li>\n<ul>\n'}]);
//# sourceMappingURL=app.js.map